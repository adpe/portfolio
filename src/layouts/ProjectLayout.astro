---
import BaseLayout from './BaseLayout.astro';

export interface Props {
  title?: string;
  description?: string;
  image?: string;
  link?: string;
  tags?: string[];
  type?: 'contribution' | 'creation';
  frontmatter?: {
    title?: string;
    description?: string;
    image?: string;
    link?: string;
    tags?: string[];
    type?: 'contribution' | 'creation';
  };
}

// Handle both .astro and .mdx frontmatter formats
const { frontmatter, ...directProps } = Astro.props;
const props = frontmatter || directProps;
const { 
  title = 'Untitled', 
  description, 
  image, 
  link, 
  tags = [], 
  type = 'creation' 
} = props;
const backLink = type === 'contribution' ? '/#contributions' : '/#creations';
---

<BaseLayout title={title} description={description}>
  <nav aria-label="breadcrumb" class="p-3 px-lg-5">
    <ol class="breadcrumb mb-0">
      <li class="breadcrumb-item">
        <a href="/">Home</a>
      </li>
      <li class="breadcrumb-item">
        <a href={backLink}>{type === 'contribution' ? 'Contributions' : 'Creations'}</a>
      </li>
      <li class="breadcrumb-item active">{title}</li>
    </ol>
  </nav>

  <section class="resume-section p-3 p-lg-5 d-flex d-column">
    <div class="my-auto">
      <h2 class="mb-0"><span class="text-primary">{title}</span></h2>
      
      <slot />
      
      {tags && tags.length > 0 && (
        <ul class="tags">
          {tags.map((tag) => (
            <li><span class="tag">{tag}</span></li>
          ))}
        </ul>
      )}
      
      {link && <p>Project link: <a href={link}>{link}</a></p>}
      
      <script src="https://utteranc.es/client.js"
              repo="adpe/portfolio"
              issue-term="pathname"
              label="blog"
              theme="github-light"
              crossorigin="anonymous"
              async>
      </script>
      
      <a href={backLink}><button type="button" class="btn btn-outline-secondary btn-sm mt-3"><i class="fa fa-long-arrow-left me-2" aria-hidden="true"></i>back</button></a>
    </div>
  </section>
</BaseLayout>

<style>
  ul.tags {
    font: 12px/1.5 'PT Sans', serif;
    list-style: none;
    margin: 0;
    overflow: hidden;
    padding: 0;
  }

  ul.tags li {
    float: left;
  }

  ul.tags li span.tag {
    background: #eee;
    border-radius: 3px 0 0 3px;
    color: #999;
    display: inline-block;
    height: 26px;
    line-height: 26px;
    margin: 0 10px 10px 0;
    padding: 0 20px 0 23px;
    position: relative;
    text-decoration: none;
    -webkit-transition: color 0.2s;
    transition: color 0.2s;
  }

  ul.tags li span.tag::before {
    color: #9e9e9e;
    content: '\f02b';
    font-family: 'Font Awesome 6 Free';
    font-weight: 400;
    left: 7px;
    position: absolute;
    top: 0px;
  }

  ul.tags li span.tag::after {
    background: #fff;
    border-bottom: 13px solid transparent;
    border-left: 10px solid #eee;
    border-top: 13px solid transparent;
    content: '';
    position: absolute;
    right: 0;
    top: 0;
  }

  ul.tags li span.tag:hover {
    background-color: #007bff;
    color: white;
    text-decoration: none;
  }

  ul.tags li span.tag:hover::after {
    border-left-color: #007bff;
  }

  ul.tags li span.tag:hover::before {
    color: white;
  }
</style>
