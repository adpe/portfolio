---
export interface ProjectItem {
  id: string;
  slug: string;
  title: string;
  description: string;
  image?: string;
  link?: string;
  tags?: string[];
  weight?: number;
  featured?: boolean;
  content?: string;
  date?: string;
}

export interface Props {
  items: ProjectItem[];
  sectionTitle: string;
  sectionId: string;
  projectType: 'creations' | 'contributions' | 'publications';
  content?: string;
}

const { items, sectionTitle, sectionId, projectType, content } = Astro.props;

// Sort items by date (newest first)
const sortedItems = [...items].sort((a, b) => {
  if (a.date && b.date) {
    return new Date(b.date).getTime() - new Date(a.date).getTime();
  }
  return 0;
});
---

<section class="resume-section p-3 p-lg-5 d-flex flex-column" id={sectionId}>
  <div class="my-auto" id="projects-content">
    <h2 class="mb-5">{sectionTitle}</h2>
    {content && <div set:html={content} />}
    {sortedItems.map((project) => (
      <div>
        <h3 class="mb-3">{project.title}</h3>
        <div class="resume-item d-flex flex-column flex-md-row mb-3">
          {project.image && (
            <div class="resume-content img">
              <a
                href={project.image}
                target="_blank"
                aria-label={`View larger image of ${project.title}`}
              >
                <img
                  src={project.image}
                  alt={project.title}
                  class="project-image"
                />
              </a>
            </div>
          )}
          <div class="resume-date ms-3">
            <p>{project.description}</p>
            <p>
              <a href={`/${projectType}/${project.slug}`} class="btn btn-outline-secondary btn-sm" aria-label={`Read more about ${project.title}`}>
                Read more about {project.title}
                <i class="fa fa-long-arrow-right ms-2" aria-hidden="true"></i>
              </a>
            </p>
          </div>
        </div>
        {project.tags && project.tags.length > 0 && (
          <div>
            <ul class="tags">
              {project.tags.map((tag) => (
                <li>
                  <a class="tag" href={`/tags/${tag.toLowerCase().replace(/\s+/g, '-')}`}>
                    {tag}
                  </a>
                </li>
              ))}
            </ul>
          </div>
        )}
      </div>
    ))}
  </div>
</section>
